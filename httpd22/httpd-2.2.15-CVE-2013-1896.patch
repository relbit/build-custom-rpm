https://bugzilla.redhat.com/show_bug.cgi?id=983549

http://svn.apache.org/viewvc?view=revision&revision=1486461
http://svn.apache.org/viewvc?view=revision&revision=1497212

--- httpd-2.2.15/modules/dav/main/mod_dav.c	2013/05/26 20:00:38	1486460
+++ httpd-2.2.15/modules/dav/main/mod_dav.c	2013/05/26 20:01:35	1486461
@@ -709,6 +709,12 @@
 
     conf = ap_get_module_config(r->per_dir_config, &dav_module);
     /* assert: conf->provider != NULL */
+    if (conf->provider == NULL) {
+        return dav_new_error(r->pool, HTTP_METHOD_NOT_ALLOWED, 0,
+                             apr_psprintf(r->pool,
+				          "DAV not enabled for %s",
+					  ap_escape_html(r->pool, r->uri)));
+    }
 
     /* resolve the resource */
     err = (*conf->provider->repos->get_resource)(r, conf->dir,
@@ -2685,11 +2691,6 @@
                                   "Destination URI had an error.");
     }
 
-    if (dav_get_provider(lookup.rnew) == NULL) {
-        return dav_error_response(r, HTTP_METHOD_NOT_ALLOWED,
-                                  "DAV not enabled for Destination URI.");
-    }
-
     /* Resolve destination resource */
     err = dav_get_resource(lookup.rnew, 0 /* label_allowed */,
                            0 /* use_checked_in */, &resnew);
